---
title: "home_work_5_7"
output: html_document
date: "2023-01-11"
---
Задача 1

Для маркетингового исследования случайным образом необходимо отобрать N людей. Этим людям далее демонстрируется кофе марки Nescafe в упаковке с новым дизайном: вместо классической этикетки в коричнево-золотых тонах – новогодняя этикетка в красно-зеленых тонах. После этого фиксируется, сколько людей захотели купить этот кофе, а точнее, доля таких людей.
Рассчитайте необходимый объем выборки для тестовой группы, если известно, что
• выбран 95%-ный уровень доверия;
• погрешность не должна превышать 3%;
• нет определенных ожиданий относительно доли людей, которые захотят кофе с измененным
дизайном этикетки (считается, что человек с равной вероятностью выберет кофе или не выберет).
Для вычислений можно использовать базовые средства R или Python, но в таком случае необходимо привести код в тексте с решением.

```{r}
library(DescTools)
```


```{r}

sampl_form <- function(z, error, p = 0.5){
  n <- round(z ** 2 * p * (1 - p) / error)
  n
}

p <- 0.5
z <- 1.96
error <- 0.03
n <- sampl_form(z, error)
n
# для тестовой группы необходима выборка не менее 32 наблюдений
```



Задача 2
Решите задачу 1, учитывая, что теперь ожидаемая доля людей, которые захотят купить кофе с измененным дизайном этикетки, известна и равна 0.67 (группа аналитиков нашла старый отчет с результатами аналогичного эксперимента).
Какой из необходимых объемов выборки больше: в случае, когда мы считаем, что шансы выбрать и не выбрать кофе одинаковы или в случае, когда ожидаемая доля выбравших кофе нам известна и равна 0.67? Сделайте вывод о связи между ожидаемой долей и необходимым объемом выборки при прочих равных условиях (тот же уровень доверия).



```{r}
p <- 0.67
n <- sampl_form(z, error, p)
n
# на этот раз нам понадобится только 28 наблюдений
# чем выше ожидаемая доля, тем меньше наблюдейний необходимо для выборки
```


Задача 3
В файле experiment.csv сохранены результаты эксперимента, описанного в задаче 1. Данные пред- ставляют собой последовательности из 0 и 1, где 1 соответствуют людям, которые захотели выбрать кофе с измененным дизайном этикетки, а 0 - людям, которые не захотели.
Описание данных:
test: результаты по тестовой группе (людям предлагали кофе с новым дизайном этикетки); control: контрольная группа (людям предлагали кофе со старым дизайном этикетки).
1. Загрузите в R данные из файла experiment.csv с помощью функции read.csv().

```{r}
experiment <- read.csv('experiment.csv', row.names = 1)
View(experiment)
```


2. Постройте в R 90%-ный доверительный интервал для доли людей, которые захотели купить кофе,
в тестовой группе. Проинтерпретируйте полученный доверительный интервал.
В решении приведите используемый код, границы доверительного интервала и текст с интерпре- тацией.

```{r}
conf.level <- 0.9
x_test <- sum(experiment$test)
n_test = length(experiment$test)
conf.level.test <- BinomCI(x = x_test, n = n_test, conf.level = conf.level)
conf.level.test

# полученный результат позволяет нам сделать вывод, что с уверенностью в 90 % доля людей, выбирающих кофе в новой упаковке, среди всех покупателей кофе, находится в интервале от 0.55 до 0.60. Если мы будем проводить подобное исследование, при том же объеме выборки много раз, то в 90% доверительных интервалов будут включать истинное значение доли людей, выбирающих новую упаковку. 
```


3. Постройте в R 90%-ный доверительный интервал для доли людей, которые захотели купить кофе, в контрольной группе. Проинтерпретируйте полученный доверительный интервал.
В решении приведите используемый код, границы доверительного интервала и текст с интерпре- тацией.

```{r}
x.contrl <- sum(experiment$control)
n.contrl <- length(experiment$control)
conf.level.contr <- BinomCI(x = x.contrl, n = n.contrl, conf.level = conf.level)
conf.level.contr
# с уверенностью в 90 % можем сказать, что доля людей, выбирающих кофе в старой упаковке, среди всех покупателей кофе находится в интервале от 0.44 до 0.49. Если мы будем проводить аналогичные исследования независимо друг от друга на многочисленных выборках того же размера, то 90% доверительных интервалов будут включать в себя истинное значение доли желающих купить кофе в старой упаковке. 
```

4. Сравните полученные доверительные интервалы для тестовой и контрольной группы. Можно ли на основании полученных результатов сделать определенный вывод о том, что новый дизайн этикетки лучше (привлекает больше потенциальных покупателей)? Приведите ваши выводы и объяснения.

```{r}

# на основании полученных результатов мы можем сдлеать вывод, что новая упаковка привлекает больше покупателей, так как найденные доверительные интервалы контрольной и тестовой групп не пересекаются



test_share <- cbind.data.frame(conf.level.test[2:3], c(0, 0))
contr_share <- cbind.data.frame(conf.level.contr[2:3], c(0, 0))

xrange <- c(conf.level.contr[2:3], conf.level.test[2:3])
yrange <- c(rep(0, length(xrange)))

plot(xrange, 
     yrange,  
     main = 'Довенительные интервалы',
     xlab = 'Доля',
     ylab = '',
     type = 'n')

lines(test_share, type = 'o', lwd = 3,col = 'skyblue')
lines(contr_share, type = 'o', lwd = 3, col = 'lightgreen')
col.lines <- c('skyblue', 'lightgreen')
lab.lines <- c('Тестовая группа', 'Контрольная группа')
legend('topright', lab.lines, fill = col.lines)
grid()

 
```



